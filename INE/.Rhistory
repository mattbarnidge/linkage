}
#Print results (3-class model is best, according to BIC)
print(LCA_best_model)
#Estimate Model, re-set order based on predicted probabilities
#(biggest group first), then re-estimate models
lc <- poLCA(f, x, nclass=3,
maxiter=3000, tol=1e-5,
na.rm=TRUE,  nrep=10,
verbose=TRUE, calc.se=TRUE,
graph=TRUE) #initial model
probs.start <- poLCA.reorder(lc$probs.start,
order(lc$P, decreasing=TRUE)) #create object for order
lc <- poLCA(f, x, nclass = 3,
maxiter=3000, tol=1e-5,
na.rm=TRUE, nrep=10,
verbose=TRUE, calc.se=TRUE,
probs.start = probs.start,
graph=TRUE) #refit model with order object (probs.start)
#Clean up environment
rm(f,
i,
min_bic,
LCA_best_model,
probs.start)
detach("package:poLCA", unload=TRUE)
#Extract grouping variable and add to dataset
x$inv = as.factor(lc$predclass)
table(x$inv)
#Group 1 = low involvement (48%)
#Group 2 = medium involvement (37.5%)
#Group 3 = high involvement (14.5%)
library(lme4)
library(lmerTest)
x$incexp = as.factor(x$incexp)
lg4 = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(lg4, cor=FALSE); logLik(lg4); performance::r2(lg4); performance::icc(lg4)
summary(lg4, cor=FALSE); logLik(lg4); performance::r2(lg4); performance::icc(lg4)
visreg::visreg(lg4, "incexp", by="inv", ylab="Engagement", xlab="Exposure Type")
with(x, round(cor(cbind(mot, int, fol, alg),
use="complete.obs"), digits=2))
#Set WD and load data
setwd("~/Documents/GitHub/linkage/INE")
load("ine.Rdata")
with(x, round(cor(cbind(mot, int, fol, alg),
use="complete.obs"), digits=2))
x$x1 = x$mot + 1
x$x2 = round(x$int, digits = 0)
x$x3 = round(x$fol, digits = 0)
x$x4 = x$alg + 1
f <- cbind(x1, x2, x3, x4) ~ 1
library(poLCA)
min_bic <- 100000
for(i in 2:5){
lc <- poLCA(f, x, nclass=i,
maxiter=3000, tol=1e-5,
na.rm=FALSE, nrep=10,
verbose=TRUE, calc.se=TRUE)
if(lc$bic < min_bic){
min_bic <- lc$bic
LCA_best_model <- lc
}
}
lc <- poLCA(f, x, nclass=3,
maxiter=3000, tol=1e-5,
na.rm=TRUE,  nrep=10,
verbose=TRUE, calc.se=TRUE,
graph=TRUE) #initial model
probs.start <- poLCA.reorder(lc$probs.start,
order(lc$P, decreasing=TRUE)) #create object for order
lc <- poLCA(f, x, nclass = 3,
maxiter=3000, tol=1e-5,
na.rm=TRUE, nrep=10,
verbose=TRUE, calc.se=TRUE,
probs.start = probs.start,
graph=TRUE) #refit model with order object (probs.start)
#Clean up environment
rm(f,
i,
min_bic,
LCA_best_model,
probs.start)
detach("package:poLCA", unload=TRUE)
#Extract grouping variable and add to dataset
x$inv = as.factor(lc$predclass)
table(x$inv)
#Group 1 = low involvement (48%)
#Group 2 = medium involvement (37.5%)
#Group 3 = high involvement (14.5%)
#Load Libraries
library(lme4)
library(lmerTest)
lm1 = lmer(ipe ~ inv +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur +
(1 | frame),
data=x, weights=weights,
control=lmerControl(optimizer="bobyqa"))
lg1 = glmer(incexp.sk ~ inv +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=x, family=poisson, weights=weights,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
lm2 = lmer(pol ~ inv + iny +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur +
(1 | frame),
data=x, weights=weights,
control=lmerControl(optimizer="bobyqa"))
lg2 = glmer(recall ~ inv +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=x, family=poisson, weights=weights,
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(lm1, cor=FALSE); logLik(lm1); performance::r2(lm1); performance::icc(lm1)
options(scipen=999)
summary(lm1, cor=FALSE); logLik(lm1); performance::r2(lm1); performance::icc(lm1)
summary(lg1, cor=FALSE); logLik(lg1); performance::r2(lg1); performance::icc(lg1)
summary(lg2, cor=FALSE); logLik(lg2); performance::r2(lg1); performance::icc(lg2)
summary(lg1, cor=FALSE); logLik(lg1); performance::r2(lg1); performance::icc(lg1)
summary(lg2, cor=FALSE); logLik(lg2); performance::r2(lg1); performance::icc(lg2)
x$incexp = as.factor(x$incexp)
lg3 = lmer(story.engage ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
lg4 = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(lg3, cor=FALSE); logLik(lg3); performance::r2(lg3); performance::icc(lg3)
table(x$recall)
par(mfrow=c(1,1))
visreg::visreg(lg3, "incexp", by="inv", ylab="Engagement", xlab="Exposure Type")
visreg::visreg(lg4, "incexp", by="inv", ylab="Engagement", xlab="Exposure Type")
lg4 = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(lg4, cor=FALSE); logLik(lg4); performance::r2(lg4); performance::icc(lg4)
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", ylab="Incidental Exposure", xlab="Involvement")
visreg::visreg(lg1, "inv", ylab="Incidental Exposure", xlab="Involvement")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="Involvement")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", ylab="Incidental Exposure", xlab=)
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="Involvement")
visreg::visreg(lm1, "inv", ylab="Incidental Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="Involvement")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", ylab="Incidental Exposure", xlab="Involvement")
visreg::visreg(lg1, "inv", ylab="Incidental Exposure", xlab="Involvement")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="Involvement")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="Involvement")
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="")
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", main="Trait-Like", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", main="State-Like", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", main="Trait-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", main="State-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", main="Trait-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", main="State-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", ylab="Story Exposure", xlab="Involvement")
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", jitter=TRUE, line=list(col="darkgrey"),
main="Trait-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", jitter=TRUE, line=list(col="darkgrey"),
main="State-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", jitter=TRUE, line=list(col="darkgrey"),
ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", jitter=TRUE, line=list(col="darkgrey"),
ylab="Story Exposure", xlab="Involvement")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", jitter=TRUE, line=list(col="black"),
main="Trait-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", jitter=TRUE, line=list(col="black"),
main="State-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", jitter=TRUE, line=list(col="black"),
ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", jitter=TRUE, line=list(col="black"),
ylab="Story Exposure", xlab="Involvement")
#Visualizations
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", jitter=TRUE, line=list(col="black"), gg=TRUE,
main="Trait-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", jitter=TRUE, line=list(col="black"), gg=TRUE,
main="State-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", jitter=TRUE, line=list(col="black"), gg=TRUE,
ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", jitter=TRUE, line=list(col="black"), gg=TRUE,
ylab="Story Exposure", xlab="Involvement")
par(mfrow=c(2,2))
visreg::visreg(lm1, "inv", jitter=TRUE, line=list(col="black"),
main="Trait-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lg1, "inv", jitter=TRUE, line=list(col="black"),
main="State-Like DV", ylab="Incidental Exposure", xlab="")
visreg::visreg(lm2, "inv", jitter=TRUE, line=list(col="black"),
ylab="Total Exposure", xlab="Involvement")
visreg::visreg(lg2, "inv", jitter=TRUE, line=list(col="black"),
ylab="Story Exposure", xlab="Involvement")
#Visualizations
par(mfrow=c(1,1))
visreg::visreg(lg3, "incexp", by="inv", jitter=TRUE, line=list(col="black"),
ylab="Engagement", xlab="Exposure Type")
visreg::visreg(lg4, "incexp", by="inv", jitter=TRUE, line=list(col="black"),
ylab="Engagement", xlab="Exposure Type")
x$inv <- factor(x$inv,
levels = c(1,2,3),
labels = c("Low", "Med", "High"))
x$incexp <- factor(x$inv,
levels = c(0,1),
labels = c("Purp.", "Inc."))
lg3.n = lmer(story.engage ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
lg4.n = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
#Load Libraries
library(dplyr)
library(tidyr)
#Set WD and load data
setwd("~/Documents/GitHub/linkage/INE")
load("ine.Rdata")
#RQ1: How can we categorize people according to "involvement" with the news?
#Analysis overview: perform latent class analysis with four indicators
#of involvement, including environmental perception (social media as news source),
#interest, following accounts for news, and algorithmic categorization
#Results overview: LCA reveals three groups, which are arrayed
#in a more or less linear manner from high involvement to low involvement
#Correlations among indicators of involvement (.33 < r < .53)
with(x, round(cor(cbind(mot, int, fol, alg),
use="complete.obs"), digits=2))
#LCA based on indicators of involvement
#Recode variables for LCA (LCA requires non-zero integers)
x$x1 = x$mot + 1
x$x2 = round(x$int, digits = 0)
x$x3 = round(x$fol, digits = 0)
x$x4 = x$alg + 1
#Define LCA function
f <- cbind(x1, x2, x3, x4) ~ 1
#Load Library for LCA
library(poLCA)
lc <- poLCA(f, x, nclass=3,
maxiter=3000, tol=1e-5,
na.rm=TRUE,  nrep=10,
verbose=TRUE, calc.se=TRUE,
graph=TRUE) #initial model
probs.start <- poLCA.reorder(lc$probs.start,
order(lc$P, decreasing=TRUE)) #create object for order
lc <- poLCA(f, x, nclass = 3,
maxiter=3000, tol=1e-5,
na.rm=TRUE, nrep=10,
verbose=TRUE, calc.se=TRUE,
probs.start = probs.start,
graph=TRUE) #refit model with order object (probs.start)
#Clean up environment
rm(f,
i,
min_bic,
LCA_best_model,
probs.start)
detach("package:poLCA", unload=TRUE)
#Extract grouping variable and add to dataset
x$inv = as.factor(lc$predclass)
table(x$inv)
x$inv = as.factor(lc$predclass)
table(x$inv)
x$incexp = as.factor(x$incexp)
#Fit models
lg3 = lmer(story.engage ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
lg4 = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
x$inv <- factor(x$inv,
levels = c(1,2,3),
labels = c("Low", "Med", "High"))
table(x$inv)
x$incexp <- factor(x$inv,
levels = c(0,1),
labels = c("Purp.", "Inc."))
table(x$incexp)
#Set WD and load data
setwd("~/Documents/GitHub/linkage/INE")
load("ine.Rdata")
#Correlations among indicators of involvement (.33 < r < .53)
with(x, round(cor(cbind(mot, int, fol, alg),
use="complete.obs"), digits=2))
#LCA based on indicators of involvement
#Recode variables for LCA (LCA requires non-zero integers)
x$x1 = x$mot + 1
x$x2 = round(x$int, digits = 0)
x$x3 = round(x$fol, digits = 0)
x$x4 = x$alg + 1
#Define LCA function
f <- cbind(x1, x2, x3, x4) ~ 1
library(poLCA)
lc <- poLCA(f, x, nclass=3,
maxiter=3000, tol=1e-5,
na.rm=TRUE,  nrep=10,
verbose=TRUE, calc.se=TRUE,
graph=TRUE) #initial model
probs.start <- poLCA.reorder(lc$probs.start,
order(lc$P, decreasing=TRUE)) #create object for order
lc <- poLCA(f, x, nclass = 3,
maxiter=3000, tol=1e-5,
na.rm=TRUE, nrep=10,
verbose=TRUE, calc.se=TRUE,
probs.start = probs.start,
graph=TRUE) #refit model with order object (probs.start)
rm(f,
i,
min_bic,
LCA_best_model,
probs.start)
detach("package:poLCA", unload=TRUE)
x$inv = as.factor(lc$predclass)
table(x$inv)
library(lme4)
library(lmerTest)
#Recode incexp variable (state) to be factor (for visualization)
x$incexp = as.factor(x$incexp)
#Fit models
lg3 = lmer(story.engage ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
lg4 = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
x$inv <- factor(x$inv,
levels = c(1,2,3),
labels = c("Low", "Med", "High"))
x$incexp <- factor(x$incexp,
levels = c(0,1),
labels = c("Purp.", "Inc."))
table(x$incexp)
lg3.v = lmer(story.engage ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
lg4.v = lmer(story.engage.he ~ inv*incexp +
age + female + poc + edu + inc + ideo + pid +
sm.freq + size + div + grp + cur + ipe +
(1 | frame),
data=subset(x, recall==1),
control=lmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
par(mfrow=c(1,1))
visreg::visreg(lg3, "incexp", by="inv", jitter=TRUE, line=list(col="black"),
ylab="Engagement", xlab="Exposure Type")
par(mfrow=c(1,1))
visreg::visreg(lg3.v, "incexp", by="inv", jitter=TRUE, line=list(col="black"),
ylab="Engagement", xlab="Exposure Type")
visreg::visreg(lg4.v, "incexp", by="inv", jitter=TRUE, line=list(col="black"),
ylab="Engagement", xlab="Exposure Type")
#Load Libraries
library(dplyr)
library(tidyr)
#Set WD and load data
setwd("~/Documents/GitHub/linkage/INE")
load("ine.Rdata")
#RQ1: How can we categorize people according to "involvement" with the news?
#Analysis overview: perform latent class analysis with four indicators
#of involvement, including environmental perception (social media as news source),
#interest, following accounts for news, and algorithmic categorization
#Results overview: LCA reveals three groups, which are arrayed
#in a more or less linear manner from high involvement to low involvement
#Correlations among indicators of involvement (.33 < r < .53)
with(x, round(cor(cbind(mot, int, fol, alg),
use="complete.obs"), digits=2))
#LCA based on indicators of involvement
#Recode variables for LCA (LCA requires non-zero integers)
x$x1 = x$mot + 1
x$x2 = round(x$int, digits = 0)
x$x3 = round(x$fol, digits = 0)
x$x4 = x$alg + 1
#Define LCA function
f <- cbind(x1, x2, x3, x4) ~ 1
#Load Library for LCA
library(poLCA)
#Write function to find best fitting model
#min = 2 classes, max = 5 classes (trouble with convergence above 5)
min_bic <- 100000
for(i in 2:5){
lc <- poLCA(f, x, nclass=i,
maxiter=3000, tol=1e-5,
na.rm=FALSE, nrep=10,
verbose=TRUE, calc.se=TRUE)
if(lc$bic < min_bic){
min_bic <- lc$bic
LCA_best_model <- lc
}
}
#Print results (3-class model is best, according to BIC)
print(LCA_best_model)
#Estimate Model, re-set order based on predicted probabilities
#(biggest group first), then re-estimate models
lc <- poLCA(f, x, nclass=3,
maxiter=3000, tol=1e-5,
na.rm=TRUE,  nrep=10,
verbose=TRUE, calc.se=TRUE,
graph=TRUE) #initial model
probs.start <- poLCA.reorder(lc$probs.start,
order(lc$P, decreasing=TRUE)) #create object for order
lc <- poLCA(f, x, nclass = 3,
maxiter=3000, tol=1e-5,
na.rm=TRUE, nrep=10,
verbose=TRUE, calc.se=TRUE,
probs.start = probs.start,
graph=TRUE) #refit model with order object (probs.start)
mean(x$pol); sd(x$pol)
mean(x$ipe); sd(x$ipe)
summary(x$pol)
summary(x$ipe)
names(x)
table(x$recall)
842/2008
table(x$incexp)
table(x$incexp, x$recall)
388+454
454/2008
454/842
names(x)
table(x$story.engage)
with(subset(x$recall==1), mean(story.engage))
with(subset(x, recall==1), mean(story.engage))
with(subset(x, recall==1), sd(story.engage))
with(subset(x, recall==1), mean(story.engage.he))
with(subset(x, recall==1), sd(story.engage.he))
table(x$story.engage.he)
table(x$mot)
709/2008
table(x$int)
mean(x$int); sd(x$int)
mean(x$fol); sd(x$fol); summary(x$fol)
table(x$alg)
833/2008
names(x)
summary(x$size); mean(x$size); sd(x$size)
summary(x$div); mean(x$div); sd(x$div)
hist(x$div)
summary(x$grp); mean(x$grp); sd(x$grp)
summary(x$cur); mean(x$cur); sd(x$cur)
names(x)
summary(x$age); mean(x$age); sd(x$age)
table(x$female)
table(x$poc)
summary(x$edu); mean(x$edu); sd(x$edu)
summary(x$inc); mean(x$inc); sd(x$inc)
summary(x$ideo); mean(x$ideo); sd(x$ideo)
summary(x$pid); mean(x$pid); sd(x$pid)
summary(x$sm.freq); mean(x$sm.freq); sd(x$sm.freq)
1027/2008
809/2008
